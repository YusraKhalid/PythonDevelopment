{% extends "api/base.html" %}
{% block title %}
    Login Page
{% endblock %}
{% block sidebar %}
    {{ block.super }}
    <li><a href="{% url 'api:signup' %}">Signup</a></li>
{% endblock %}
{% block heading %}
    Login Form
{% endblock %}
{% block content %}

    <div class="col-md-4 col-md-offset-3">
        {% load rest_framework %}
        <form id="loginForm" action="" method="POST">
            {% csrf_token %}
            {% render_form serializer %}
            <input id="submitButton" type="submit" value="Login" class="btn btn-primary">
        </form>
    </div>
    <script
            src="http://code.jquery.com/jquery-3.2.1.js"
            integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
            crossorigin="anonymous"></script>
    <script>
        $('#submitButton').click(function (evt) {
            var form = $('#loginForm');
            var credentials = {
                username: $('input[name="username"]').val(),
                password: $('input[name="password"]').val()
            };
            $.post("{% url 'api:token' %}", credentials, function (auth) {
                $.cookie("token", auth.token, {path: '', domain: '', secure: true});

            });
        })
    </script>
{% endblock content %}
