{% extends "memoapp/base.html" %}
{% block page_title %}Memo Book{% endblock page_title %}

{% block body %}
<div class="container">
        <div class="row">
			<div class="col-md-6 col-md-offset-3">
				<div class="panel panel-login">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<a href="#" class="active" id="login-form-link">Login</a>
							</div>
							<div class="col-xs-6">
								<a href="#" id="register-form-link">Register</a>
							</div>
						</div>
						<hr>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-lg-12">
								<form id="login-form" action="/login" method="post" role="form" style="display: {% if view == 'signup' %}  {{ 'none' }} {% else %} {{ 'block' }} {% endif %}">
									{% csrf_token %}
                                    {% if error_message %}
                                        <div class="form-group">
										    <div class="row">
											    <div class="col-sm-8 col-sm-offset-3">
                                                    <strong><span class="alert-danger"> {{ error_message }} </span></strong>
                                                </div>
										    </div>
									    </div>
                                    {% endif %}
                                    <div class="form-group">
										    <div class="row">

											    <div class="col-sm-8">
                                                    <strong><span style="margin: 5px; color: red" id="login_email_span">  </span></strong>
                                                </div>
                                                <div class="col-md-12">
                                                    {{ login_form.login_email }}
                                                </div>
										    </div>
                                    </div>
                                    <div class="form-group">
										    <div class="row">
                                                <div class="col-sm-8">
                                                    <strong><span style="padding: 5px; color: red" id="login_password_span">  </span></strong>
                                                </div>
                                                <div class="col-md-12">
                                                    {{ login_form.login_password }}
                                                </div>
										    </div>
                                    </div>


									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="submit" onclick="return validate_login_form()" name="login-submit" id="login-submit" tabindex="4" class="form-control btn btn-login" value="Log In">
											</div>
										</div>
									</div>

								</form>
								<form id="register-form" action="/signup" method="post" enctype="multipart/form-data" role="form" style="display: {% if view == 'signup' %}  {{ 'block' }} {% else %} {{ 'none' }} {% endif %}">
									 {% csrf_token %}
                                     {% if username_error %}
                                        <div class="form-group">
										    <div class="row">
											    <div class="col-sm-8 col-sm-offset-3">
                                                    <strong><span class="alert-danger"> {{ username_error }} </span></strong>
                                                </div>
										    </div>
									    </div>
                                     {% endif %}
                                    <div class="form-group">
										    <div class="row">
                                                <div class="col-md-12">
                                                    {{ signup_form.first_name }}
                                                </div>
										    </div>
                                    </div>
                                    <div class="form-group">
										    <div class="row">
											    <div class="col-sm-8">
                                                    <strong><span style="margin: 5px; color: red" id="email_span">  </span></strong>
                                                </div>
                                                <div class="col-md-12">
                                                    {{ signup_form.email.errors }}
                                                    {{ signup_form.email }}
                                                </div>
										    </div>
                                    </div>
                                    <div class="form-group">
										    <div class="row">
											    <div class="col-sm-8">
                                                    <strong><span style="margin: 5px; color: red" id="username_span">  </span></strong>
                                                </div>
                                                <div class="col-md-12">
                                                     {{ signup_form.username.errors }}
                                                    {{ signup_form.username }}
                                                </div>
										    </div>
                                    </div>
                                    <div class="form-group">
										    <div class="row">
											    <div class="col-sm-8">
                                                    <strong><span style="margin: 5px; color: red" id="password_span">  </span></strong>
                                                </div>
                                                <div class="col-md-12">
                                                    {{ signup_form.password }}
                                                </div>
										    </div>
                                    </div>
									<div class="form-group">
										<div class="row">
											<div class="col-sm-6 col-sm-offset-3">
												<input type="submit"  name="register-submit" onclick="return validate_signup_form()" id="register-submit" tabindex="4" class="form-control btn btn-register" value="Register Now">
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script>
        function validateEmail(email) {
            var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(email);
        };
        function validate_login_form() {
            var is_valid = true;
            if (!validateEmail($("input[name='login_email']").val()))
            {
                $('#login_email_span').html('Email is not valid');
                is_valid = false;
            }
            if ($("input[name='login_password']").val().length < 8)
            {
                 $('#login_password_span').html('Password is not valid');
                is_valid = false;
            }
            return is_valid;
        };

        function validate_signup_form(){
            var is_valid = true;
            if (!validateEmail($("input[name='email']").val())){
                 $('#email_span').html('Email is not valid');
                is_valid = false;
            };
            if ($("input[name='password']").val().length < 8){
                 $('#password_span').html('Password is not valid');
                is_valid = false;
            };
            if (!$("input[name='username']").val()){
                 $('#username_span').html('Username is not valid');
                is_valid = false;
            };
            return is_valid;
        };
    </script>

{% endblock body %}
